{% extends "page.html" %}

{%- block main_content %}

    {% block flash %}
        {{ super() }}
    {% endblock %}

    {% block toolbar %}
        {{ super() }}
    {% endblock %}

    <p><a href="/reporting/{{ org_id }}">&lt; Back to report</a></p>

    <h1>Report: Data requests</h1>

    <h2>
        {% if metric == 'no-comments' %}
            Open data requests with no comment > 10 days
        {% elif metric == 'closed' %}
            Closed data requests - To be released as open data at a later date
        {% elif metric == 'open-max-days' %}
            Open data requests > 60 days
        {% endif %}
    </h2>

    {% if datarequests|length > 0 %}
        <ul class="dataset-list list-unstyled">
        {% for datarequest in datarequests %}
            <li class="dataset-item">
                <div class="dataset-content">
                    <h3 class="dataset-heading">
                        <a href="/datarequest/{{ datarequest.id }}">{{ datarequest.title }}</a>
                    </h3>

                    <strong>Opened:</strong> {{ h.render_datetime(datarequest.open_time, None, True) }}

                    &mdash; {{ h.time_ago_from_timestamp(datarequest.open_time) }}

                    {% if metric in ['closed'] %}
                        <br />
                        <strong>Closed:</strong> {{ h.render_datetime(datarequest.close_time, None, True) }}
                        <br />
                        <strong>Close circumstance:</strong> {{ datarequest.close_circumstance }}
                    {% endif %}

                    {% if circumstance in ['To be released as open data at a later date'] %}
                        <br />
                        <strong>Approximate publishing date:</strong> {{ h.render_datetime(datarequest.approx_publishing_date, None, True) }}
                    {% endif %}
                </div>
            </li>
        {% endfor %}
        </ul>
    {% endif %}

{% endblock -%}